"use strict";var virtualDG,colspans=[1,2,4,8,16];function generateHeaders(e,t){for(var n=[],r=0;r<t;r++){n.push([]);for(var a=colspans[t-r-1],o=1;o<=e/a;o++)n[r].push({key:"column_"+o,text:o+". column",dataType:"text",colspan:a})}return n}function generateFixedHeaders(e,t){for(var n=[],r=0;r<t;r++){n.push([]);for(var a=colspans[t-r-1],o=1;o<=e/a;o++)n[r].push({key:"fixed_column_"+o,text:o+". fixed column",dataType:"text",colspan:a})}return n}function generateData(e,t,n){var r,a,o,u=[],l=e.length-1;for(r=1;r<=n;r++){for(o={column_1:r},a=1;a<=e[l].length;a++)o[e[l][a-1].key]=r*(a+1)+". cell";for(a=1;a<=t[l].length;a++)o[t[l][a-1].key]=r*(a+1)+". cell";u.push(o)}return u}function generateDataGrid(){(virtualDG=new window.VirtualDataGrid).generateTable(getOptionsFromInputs())}function setupOptionContainer(){var e=window.innerHeight-document.querySelector(".root-container").getBoundingClientRect().top-20;document.querySelector(".generator-container").style.maxHeight=e+"px",document.querySelector(".generator-container").style.height=e+"px"}function setupOptions(){void 0===virtualDG&&(virtualDG=new window.VirtualDataGrid);var e=document.querySelectorAll("[name]");null!==e&&e.forEach(function(e){var t=e.getAttribute("type");"radio"!==t&&"checkbox"!==t&&(e.value="")}),Object.keys(virtualDG.DEFAULT_OPTIONS).forEach(function(e){fillInputsWithOptions(e,virtualDG.DEFAULT_OPTIONS[e])})}function fillInputsWithOptions(e,t){null!==t&&"object"==typeof t&&Object.keys(t).forEach(function(n){fillInputsWithOptions(e+"-"+n,t[n])});var n=document.querySelector("[name="+e+"]");if(null!==n&&"function"!=typeof t&&null!==t){var r=n.getAttribute("type");if("true"===n.getAttribute("data-no-default"))return;"radio"===r||"checkbox"===r?document.querySelectorAll("[name="+e+"]").forEach(function(e){e.checked=e.value===t+""}):n.value="object"==typeof t?JSON.stringify(t,null,2):t}}function getOptionsFromInputs(){var e={},t={};return document.querySelectorAll("[name]").forEach(function(t){var n=t.getAttribute("type"),r=t.classList.contains("function"),a=t.classList.contains("json");if("radio"!==n&&"checkbox"!==n||t.matches(":checked")){var o=t.value;""!==o&&("true"===o?o=!0:"false"===o&&(o=!1),r&&(o=evalFunctionValues(t)),a&&(o=JSON.parse(t.value)),"number"===n&&(o=parseInt(t.value,10)),e[t.getAttribute("name")]=o)}}),Object.keys(e).forEach(function(n){for(var r=n.split("-"),a=null,o=0;o<r.length;o++){var u=r[o];null===a?r.length-1===o?t[u]=e[n]:(void 0===t[u]&&(t[u]={}),a=t[u]):r.length-1===o?a[u]=e[n]:(void 0===a[u]&&(a[u]={}),a=a[u])}}),t}function evalFunctionValues(e){var t=e.getAttribute("data-attributes").split(",");return Function(t,e.value)}var isEventDelayed=!1;function resizeEventHandler(){isEventDelayed||(isEventDelayed=!0,window.setTimeout(function(){isEventDelayed=!1,setupOptionContainer()},200))}function initPage(){setupOptionContainer(),setupOptions(),getOptionsFromInputs()}window.addEventListener("load",function(){var e=document.querySelector("#generate-table"),t=document.querySelector("#test-options"),n=document.querySelector("#reset-to-default"),r=document.querySelector("#generate-data");initPage(),window.addEventListener("resize",resizeEventHandler),null!==e&&e.addEventListener("click",function(){var e=document.querySelector(".main-container");null!==e&&(e.innerHTML=""),generateDataGrid()}),null!==t&&t.addEventListener("click",function(){window.console.log(getOptionsFromInputs())}),null!==n&&n.addEventListener("click",setupOptions),null!==r&&r.addEventListener("click",function(){var e=document.querySelector("[name=headers]"),t=document.querySelector("[name=fixedHeaders]"),n=document.querySelector("[name=dataSource]"),r=document.querySelector("#data-generator-header-size"),a=document.querySelector("#data-generator-fixed-header-size"),o=document.querySelector("#data-generator-headers-row-size"),u=document.querySelector("#data-generator-data-size");if(null!==e&&null!==t&&null!==n&&null!==r&&null!==a&&null!==o&&null!==u){var l=parseInt(r.value,10),i=parseInt(a.value,10),c=parseInt(o.value,10),s=parseInt(u.value,10),d=generateHeaders(l,c),f=generateFixedHeaders(i,c),v=generateData(d,f,s);e.value=JSON.stringify(d,null,2),t.value=JSON.stringify(f,null,2),n.value=JSON.stringify(v,null,2)}})});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1haW4uanMiXSwibmFtZXMiOlsidmlydHVhbERHIiwiY29sc3BhbnMiLCJnZW5lcmF0ZUhlYWRlcnMiLCJoZWFkZXJTaXplIiwiaGVhZGVyc1Jvd1NpemUiLCJoZWFkZXJzIiwiaSIsInB1c2giLCJjb2xzcGFuTnVtYmVyIiwiaiIsImtleSIsInRleHQiLCJkYXRhVHlwZSIsImNvbHNwYW4iLCJnZW5lcmF0ZUZpeGVkSGVhZGVycyIsImdlbmVyYXRlRGF0YSIsImZpeGVkSGVhZGVycyIsImRhdGFzb3VyY2VTaXplIiwicm93IiwiZHMiLCJsYXN0SGVhZGVySW5kZXgiLCJsZW5ndGgiLCJjb2x1bW5fMSIsImdlbmVyYXRlRGF0YUdyaWQiLCJ3aW5kb3ciLCJWaXJ0dWFsRGF0YUdyaWQiLCJnZW5lcmF0ZVRhYmxlIiwiZ2V0T3B0aW9uc0Zyb21JbnB1dHMiLCJzZXR1cE9wdGlvbkNvbnRhaW5lciIsImdlbmVyYXRvckNvbnRhaW5lckhlaWdodCIsImlubmVySGVpZ2h0IiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwiZ2V0Qm91bmRpbmdDbGllbnRSZWN0IiwidG9wIiwic3R5bGUiLCJtYXhIZWlnaHQiLCJoZWlnaHQiLCJzZXR1cE9wdGlvbnMiLCJpbnB1dHMiLCJxdWVyeVNlbGVjdG9yQWxsIiwiZm9yRWFjaCIsImlucHV0IiwiaW5wdXRUeXBlIiwiZ2V0QXR0cmlidXRlIiwidmFsdWUiLCJPYmplY3QiLCJrZXlzIiwiREVGQVVMVF9PUFRJT05TIiwiZmlsbElucHV0c1dpdGhPcHRpb25zIiwia2V5Q2hhaW4iLCJzdWJLZXkiLCJlbCIsImNoZWNrZWQiLCJKU09OIiwic3RyaW5naWZ5IiwiZmxhdE9wdGlvbnMiLCJvcHRpb25zIiwiaXNGdW5jdGlvbiIsImNsYXNzTGlzdCIsImNvbnRhaW5zIiwiaXNKc29uIiwibWF0Y2hlcyIsImV2YWxGdW5jdGlvblZhbHVlcyIsInBhcnNlIiwicGFyc2VJbnQiLCJmbGF0S2V5IiwicGFydHMiLCJzcGxpdCIsInBhcnREYXRhIiwicGFydCIsInBhcmFtQXJyYXkiLCJGdW5jdGlvbiIsImlzRXZlbnREZWxheWVkIiwicmVzaXplRXZlbnRIYW5kbGVyIiwic2V0VGltZW91dCIsImluaXRQYWdlIiwiYWRkRXZlbnRMaXN0ZW5lciIsImdlbmVyYXRlVGFibGVCdXR0b24iLCJ0ZXN0T3B0aW9uc0J1dHRvbiIsInJlc2V0VG9EZWZhdWx0QnV0dG9uIiwiZ2VuZXJhdGVEYXRhQnV0dG9uIiwiZGF0YUNvbnRhaW5lciIsImlubmVySFRNTCIsImNvbnNvbGUiLCJsb2ciLCJoZWFkZXJzSW5wdXQiLCJmaXhlZEhlYWRlcnNJbnB1dCIsImRhdGFTb3VyY2VJbnB1dCIsImZpeGVkSGVhZGVyU2l6ZSIsImRhdGFTaXplIiwiaGVhZGVyU2l6ZVZhbHVlIiwiZml4ZWRIZWFkZXJTaXplVmFsdWUiLCJoZWFkZXJzUm93U2l6ZVZhbHVlIiwiZGF0YVNpemVWYWx1ZSIsImRhdGEiXSwibWFwcGluZ3MiOiJBQUFBLGFBRUEsSUFBSUEsVUFFQUMsVUFBYSxFQUFHLEVBQUcsRUFBRyxFQUFHLElBRTdCLFNBQVNDLGdCQUFnQkMsRUFBWUMsR0FHcEMsSUFGQSxJQUFJQyxLQUVLQyxFQUFJLEVBQUdBLEVBQUlGLEVBQWdCRSxJQUFLLENBQ3hDRCxFQUFRRSxTQUlSLElBRkEsSUFBSUMsRUFBZ0JQLFNBQVNHLEVBQWlCRSxFQUFJLEdBRXpDRyxFQUFJLEVBQUdBLEdBQUtOLEVBQWFLLEVBQWVDLElBQ2hESixFQUFRQyxHQUFHQyxNQUNWRyxJQUFLLFVBQVlELEVBQ2pCRSxLQUFNRixFQUFJLFdBQ1ZHLFNBQVUsT0FDVkMsUUFBU0wsSUFLWixPQUFPSCxFQUdSLFNBQVNTLHFCQUFxQlgsRUFBWUMsR0FHekMsSUFGQSxJQUFJQyxLQUVLQyxFQUFJLEVBQUdBLEVBQUlGLEVBQWdCRSxJQUFLLENBQ3hDRCxFQUFRRSxTQUlSLElBRkEsSUFBSUMsRUFBZ0JQLFNBQVNHLEVBQWlCRSxFQUFJLEdBRXpDRyxFQUFJLEVBQUdBLEdBQUtOLEVBQWFLLEVBQWVD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bnQiOlsiJ3VzZSBzdHJpY3QnO1xuXG52YXIgdmlydHVhbERHO1xuXG52YXIgY29sc3BhbnMgPSBbIDEsIDIsIDQsIDgsIDE2IF07XG5cbmZ1bmN0aW9uIGdlbmVyYXRlSGVhZGVycyhoZWFkZXJTaXplLCBoZWFkZXJzUm93U2l6ZSkge1xuXHR2YXIgaGVhZGVycyA9IFtdO1xuXG5cdGZvciAodmFyIGkgPSAwOyBpIDwgaGVhZGVyc1Jvd1NpemU7IGkrKykge1xuXHRcdGhlYWRlcnMucHVzaChbXSk7XG5cblx0XHR2YXIgY29sc3Bhbk51bWJlciA9IGNvbHNwYW5zW2hlYWRlcnNSb3dTaXplIC0gaSAtIDFdO1xuXG5cdFx0Zm9yICh2YXIgaiA9IDE7IGogPD0gaGVhZGVyU2l6ZSAvIGNvbHNwYW5OdW1iZXI7IGorKykge1xuXHRcdFx0aGVhZGVyc1tpXS5wdXNoKHtcblx0XHRcdFx0a2V5OiAnY29sdW1uXycgKyBqLFxuXHRcdFx0XHR0ZXh0OiBqICsgJy4gY29sdW1uJyxcblx0XHRcdFx0ZGF0YVR5cGU6ICd0ZXh0Jyxcblx0XHRcdFx0Y29sc3BhbjogY29sc3Bhbk51bWJlclxuXHRcdFx0fSk7XG5cdFx0fVxuXHR9XG5cblx0cmV0dXJuIGhlYWRlcnM7XG59XG5cbmZ1bmN0aW9uIGdlbmVyYXRlRml4ZWRIZWFkZXJzKGhlYWRlclNpemUsIGhlYWRlcnNSb3dTaXplKSB7XG5cdHZhciBoZWFkZXJzID0gW107XG5cblx0Zm9yICh2YXIgaSA9IDA7IGkgPCBoZWFkZXJzUm93U2l6ZTsgaSsrKSB7XG5cdFx0aGVhZGVycy5wdXNoKFtdKTtcblxuXHRcdHZhciBjb2xzcGFuTnVtYmVyID0gY29sc3BhbnNbaGVhZGVyc1Jvd1NpemUgLSBpIC0gMV07XG5cblx0XHRmb3IgKHZhciBqID0gMTsgaiA8PSBoZWFkZXJTaXplIC8gY29sc3Bhbk51bWJlcjsgaisrKSB7XG5cdFx0XHRoZWFkZXJzW2ldLnB1c2goe1xuXHRcdFx0XHRrZXk6ICdmaXhlZF9jb2x1bW5fJyArIGosXG5cdFx0XHRcdHRleHQ6IGogKyAnLiBmaXhlZCBjb2x1bW4nLFxuXHRcdFx0XHRkYXRhVHlwZTogJ3RleHQnLFxuXHRcdFx0XHRjb2xzcGFuOiBjb2xzcGFuTnVtYmVyXG5cdFx0XHR9KTtcblx0XHR9XG5cdH1cblxuXHRyZXR1cm4gaGVhZGVycztcbn1cblxuZnVuY3Rpb24gZ2VuZXJhdGVEYXRhKGhlYWRlcnMsIGZpeGVkSGVhZGVycywgZGF0YXNvdXJjZVNpemUpIHtcblx0dmFyIGRzID0gW10sXG5cdFx0aGVhZGVyc1Jvd1NpemUgPSBoZWFkZXJzLmxlbmd0aCxcblx0XHRsYXN0SGVhZGVySW5kZXggPSBoZWFkZXJzUm93U2l6ZSAtIDE7XG5cblx0dmFyIGksIGosIHJvdywgY0tleTtcblxuXHRmb3IgKGkgPSAxOyBpIDw9IGRhdGFzb3VyY2VTaXplOyBpKyspIHtcblx0XHRyb3cgPSB7XG5cdFx0XHRjb2x1bW5fMTogaVxuXHRcdH07XG5cblx0XHRmb3IgKGogPSAxOyBqIDw9IGhlYWRlcnNbbGFzdEhlYWRlckluZGV4XS5sZW5ndGg7IGorKykge1xuXHRcdFx0Y0tleSA9IGhlYWRlcnNbbGFzdEhlYWRlckluZGV4XVtqIC0gMV0ua2V5O1xuXG5cdFx0XHRyb3dbY0tleV0gPSAoaSAqIChqICsgMSkpICsgJy4gY2VsbCc7IC8vIGVzbGludC1kaXNhYmxlLWxpbmVcblx0XHR9XG5cblx0XHRmb3IgKGogPSAxOyBqIDw9IGZpeGVkSGVhZGVyc1tsYXN0SGVhZGVySW5kZXhdLmxlbmd0aDsgaisrKSB7XG5cdFx0XHRjS2V5ID0gZml4ZWRIZWFkZXJzW2xhc3RIZWFkZXJJbmRleF1baiAtIDFdLmtleTtcblxuXHRcdFx0cm93W2NLZXldID0gKGkgKiAoaiArIDEpKSArICcuIGNlbGwnOyAvLyBlc2xpbnQtZGlzYWJsZS1saW5lXG5cdFx0fVxuXG5cdFx0ZHMucHVzaChyb3cpO1xuXHR9XG5cblx0cmV0dXJuIGRzO1xufVxuXG5mdW5jdGlvbiBnZW5lcmF0ZURhdGFHcmlkKCkge1xuXHR2aXJ0dWFsREcgPSBuZXcgd2luZG93LlZpcnR1YWxEYXRhR3JpZCgpO1xuXHR2aXJ0dWFsREcuZ2VuZXJhdGVUYWJsZShnZXRPcHRpb25zRnJvbUlucHV0cygpKTtcbn1cblxuZnVuY3Rpb24gc2V0dXBPcHRpb25Db250YWluZXIoKSB7XG5cdHZhciBnZW5lcmF0b3JDb250YWluZXJIZWlnaHQgPSB3aW5kb3cuaW5uZXJIZWlnaHQgLSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucm9vdC1jb250YWluZXInKS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS50b3AgLSAyMDtcblxuXHRkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuZ2VuZXJhdG9yLWNvbnRhaW5lcicpLnN0eWxlLm1heEhlaWdodCA9IGdlbmVyYXRvckNvbnRhaW5lckhlaWdodCArICdweCc7XG5cdGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5nZW5lcmF0b3ItY29udGFpbmVyJykuc3R5bGUuaGVpZ2h0ID0gZ2VuZXJhdG9yQ29udGFpbmVySGVpZ2h0ICsgJ3B4Jztcbn1cblxuZnVuY3Rpb24gc2V0dXBPcHRpb25zKCkge1xuXHRpZiAodHlwZW9mIHZpcnR1YWxERyA9PSAndW5kZWZpbmVkJykge1xuXHRcdHZpcnR1YWxERyA9IG5ldyB3aW5kb3cuVmlydHVhbERhdGFHcmlkKCk7XG5cdH1cblxuXHR2YXIgaW5wdXRzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnW25hbWVdJyk7XG5cblx0aWYgKGlucHV0cyAhPT0gbnVsbCkge1xuXHRcdGlucHV0cy5mb3JFYWNoKGZ1bmN0aW9uKGlucHV0KSB7XG5cdFx0XHR2YXIgaW5wdXRUeXBlID0gaW5wdXQuZ2V0QXR0cmlidXRlKCd0eXBlJyk7XG5cblx0XHRcdGlmIChpbnB1dFR5cGUgIT09ICdyYWRpbycgJiYgaW5wdXRUeXBlICE9PSAnY2hlY2tib3gnKSB7XG5cdFx0XHRcdGlucHV0LnZhbHVlID0gJyc7XG5cdFx0XHR9XG5cdFx0fSk7XG5cdH1cblxuXHRPYmplY3Qua2V5cyh2aXJ0dWFsREcuREVGQVVMVF9PUFRJT05TKS5mb3JFYWNoKGZ1bmN0aW9uKGtleSkge1xuXHRcdGZpbGxJbnB1dHNXaXRoT3B0aW9ucyhrZXksIHZpcnR1YWxERy5ERUZBVUxUX09QVElPTlNba2V5XSk7XG5cdH0pO1xufVxuXG5mdW5jdGlvbiBmaWxsSW5wdXRzV2l0aE9wdGlvbnMoa2V5Q2hhaW4sIHZhbHVlKSB7XG5cdGlmICh2YWx1ZSAhPT0gbnVsbCAmJiB0eXBlb2YgdmFsdWUgPT09ICdvYmplY3QnKSB7XG5cdFx0T2JqZWN0LmtleXModmFsdWUpLmZvckVhY2goZnVuY3Rpb24oc3ViS2V5KSB7XG5cdFx0XHRmaWxsSW5wdXRzV2l0aE9wdGlvbnMoa2V5Q2hhaW4gKyAnLScgKyBzdWJLZXksIHZhbHVlW3N1YktleV0pO1xuXHRcdH0pO1xuXHR9XG5cblx0dmFyIGlucHV0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignW25hbWU9JyArIGtleUNoYWluICsgJ10nKTtcblxuXHRpZiAoaW5wdXQgIT09IG51bGwgJiYgdHlwZW9mIHZhbHVlICE9PSAnZnVuY3Rpb24nICYmIHZhbHVlICE9PSBudWxsKSB7XG5cdFx0dmFyIGlucHV0VHlwZSA9IGlucHV0LmdldEF0dHJpYnV0ZSgndHlwZScpLFxuXHRcdFx0bm9EZWZhdWx0ID0gaW5wdXQuZ2V0QXR0cmlidXRlKCdkYXRhLW5vLWRlZmF1bHQnKTtcblxuXHRcdGlmIChub0RlZmF1bHQgPT09ICd0cnVlJykge1xuXHRcdFx0cmV0dXJuO1xuXHRcdH0gZWxzZSBpZiAoaW5wdXRUeXBlID09PSAncmFkaW8nIHx8IGlucHV0VHlwZSA9PT0gJ2NoZWNrYm94Jykge1xuXHRcdFx0ZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnW25hbWU9JyArIGtleUNoYWluICsgJ10nKS5mb3JFYWNoKGZ1bmN0aW9uKGVsKSB7XG5cdFx0XHRcdGVsLmNoZWNrZWQgPSBlbC52YWx1ZSA9PT0gdmFsdWUgKyAnJztcblx0XHRcdH0pO1xuXHRcdH0gZWxzZSBpZiAodHlwZW9mIHZhbHVlID09ICdvYmplY3QnKSB7XG5cdFx0XHRpbnB1dC52YWx1ZSA9IEpTT04uc3RyaW5naWZ5KHZhbHVlLCBudWxsLCAyKTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0aW5wdXQudmFsdWUgPSB2YWx1ZTtcblx0XHR9XG5cdH1cbn1cblxuZnVuY3Rpb24gZ2V0T3B0aW9uc0Zyb21JbnB1dHMoKSB7XG5cdHZhciBpbnB1dHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCdbbmFtZV0nKSxcblx0XHRmbGF0T3B0aW9ucyA9IHt9LFxuXHRcdG9wdGlvbnMgPSB7fTtcblxuXHRpbnB1dHMuZm9yRWFjaChmdW5jdGlvbihpbnB1dCkge1xuXHRcdHZhciBpbnB1dFR5cGUgPSBpbnB1dC5nZXRBdHRyaWJ1dGUoJ3R5cGUnKSxcblx0XHRcdGlzRnVuY3Rpb24gPSBpbnB1dC5jbGFzc0xpc3QuY29udGFpbnMoJ2Z1bmN0aW9uJyksXG5cdFx0XHRpc0pzb24gPSBpbnB1dC5jbGFzc0xpc3QuY29udGFpbnMoJ2pzb24nKTtcblxuXHRcdGlmICgoaW5wdXRUeXBlID09PSAncmFkaW8nIHx8IGlucHV0VHlwZSA9PT0gJ2NoZWNrYm94JykgJiYgIWlucHV0Lm1hdGNoZXMoJzpjaGVja2VkJykpIHtcblx0XHRcdHJldHVybjtcblx0XHR9XG5cblx0XHR2YXIgdmFsdWUgPSBpbnB1dC52YWx1ZTtcblxuXHRcdGlmICh2YWx1ZSA9PT0gJycpIHtcblx0XHRcdHJldHVybjtcblx0XHR9XG5cblx0XHRpZiAodmFsdWUgPT09ICd0cnVlJykge1xuXHRcdFx0dmFsdWUgPSB0cnVlO1xuXHRcdH0gZWxzZSBpZiAodmFsdWUgPT09ICdmYWxzZScpIHtcblx0XHRcdHZhbHVlID0gZmFsc2U7XG5cdFx0fVxuXG5cdFx0aWYgKGlzRnVuY3Rpb24pIHtcblx0XHRcdHZhbHVlID0gZXZhbEZ1bmN0aW9uVmFsdWVzKGlucHV0KTtcblx0XHR9XG5cblx0XHRpZiAoaXNKc29uKSB7XG5cdFx0XHR2YWx1ZSA9IEpTT04ucGFyc2UoaW5wdXQudmFsdWUpO1xuXHRcdH1cblxuXHRcdGlmIChpbnB1dFR5cGUgPT09ICdudW1iZXInKSB7XG5cdFx0XHR2YWx1ZSA9IHBhcnNlSW50KGlucHV0LnZhbHVlLCAxMCk7XG5cdFx0fVxuXG5cdFx0ZmxhdE9wdGlvbnNbaW5wdXQuZ2V0QXR0cmlidXRlKCduYW1lJyldID0gdmFsdWU7XG5cdH0pO1xuXG5cdE9iamVjdC5rZXlzKGZsYXRPcHRpb25zKS5mb3JFYWNoKGZ1bmN0aW9uKGZsYXRLZXkpIHtcblx0XHR2YXIgcGFydHMgPSBmbGF0S2V5LnNwbGl0KCctJyksXG5cdFx0XHRwYXJ0RGF0YSA9IG51bGw7XG5cblx0XHRmb3IgKHZhciBpID0gMDsgaSA8IHBhcnRzLmxlbmd0aDsgaSsrKSB7XG5cdFx0XHR2YXIgcGFydCA9IHBhcnRzW2ldO1xuXG5cdFx0XHRpZiAocGFydERhdGEgPT09IG51bGwpIHtcblx0XHRcdFx0aWYgKHBhcnRzLmxlbmd0aCAtIDEgPT09IGkpIHtcblx0XHRcdFx0XHRvcHRpb25zW3BhcnRdID0gZmxhdE9wdGlvbnNbZmxhdEtleV07XG5cdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0aWYgKHR5cGVvZiBvcHRpb25zW3BhcnRdID09ICd1bmRlZmluZWQnKSB7XG5cdFx0XHRcdFx0XHRvcHRpb25zW3BhcnRdID0ge307XG5cdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0cGFydERhdGEgPSBvcHRpb25zW3BhcnRdO1xuXHRcdFx0XHR9XG5cdFx0XHR9IGVsc2UgaWYgKHBhcnRzLmxlbmd0aCAtIDEgPT09IGkpIHtcblx0XHRcdFx0cGFydERhdGFbcGFydF0gPSBmbGF0T3B0aW9uc1tmbGF0S2V5XTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdGlmICh0eXBlb2YgcGFydERhdGFbcGFydF0gPT0gJ3VuZGVmaW5lZCcpIHtcblx0XHRcdFx0XHRwYXJ0RGF0YVtwYXJ0XSA9IHt9O1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0cGFydERhdGEgPSBwYXJ0RGF0YVtwYXJ0XTtcblx0XHRcdH1cblx0XHR9XG5cdH0pO1xuXG5cdHJldHVybiBvcHRpb25zO1xufVxuXG5mdW5jdGlvbiBldmFsRnVuY3Rpb25WYWx1ZXMoaW5wdXQpIHtcblx0dmFyIHBhcmFtQXJyYXkgPSBpbnB1dC5nZXRBdHRyaWJ1dGUoJ2RhdGEtYXR0cmlidXRlcycpLnNwbGl0KCcsJyk7XG5cblx0cmV0dXJuIEZ1bmN0aW9uKHBhcmFtQXJyYXksIGlucHV0LnZhbHVlKTsgLy8gZXNsaW50LWRpc2FibGUtbGluZVxufVxuXG52YXIgaXNFdmVudERlbGF5ZWQgPSBmYWxzZTtcblxuZnVuY3Rpb24gcmVzaXplRXZlbnRIYW5kbGVyKCkge1xuXHRpZiAoIWlzRXZlbnREZWxheWVkKSB7XG5cdFx0aXNFdmVudERlbGF5ZWQgPSB0cnVlO1xuXG5cdFx0d2luZG93LnNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XG5cdFx0XHRpc0V2ZW50RGVsYXllZCA9IGZhbHNlO1xuXG5cdFx0XHRzZXR1cE9wdGlvbkNvbnRhaW5lcigpO1xuXHRcdH0sIDIwMCk7XG5cdH1cbn1cblxuZnVuY3Rpb24gaW5pdFBhZ2UoKSB7XG5cdHNldHVwT3B0aW9uQ29udGFpbmVyKCk7XG5cdHNldHVwT3B0aW9ucygpO1xuXHRnZXRPcHRpb25zRnJvbUlucHV0cygpO1xufVxuXG53aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignbG9hZCcsIGZ1bmN0aW9uKCkge1xuXHR2YXIgZ2VuZXJhdGVUYWJsZUJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNnZW5lcmF0ZS10YWJsZScpLFxuXHRcdHRlc3RPcHRpb25zQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI3Rlc3Qtb3B0aW9ucycpLFxuXHRcdHJlc2V0VG9EZWZhdWx0QnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI3Jlc2V0LXRvLWRlZmF1bHQnKSxcblx0XHRnZW5lcmF0ZURhdGFCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjZ2VuZXJhdGUtZGF0YScpO1xuXG5cdGluaXRQYWdlKCk7XG5cblx0d2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ3Jlc2l6ZScsIHJlc2l6ZUV2ZW50SGFuZGxlcik7XG5cblx0aWYgKGdlbmVyYXRlVGFibGVCdXR0b24gIT09IG51bGwpIHtcblx0XHRnZW5lcmF0ZVRhYmxlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24oKSB7XG5cdFx0XHR2YXIgZGF0YUNvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5tYWluLWNvbnRhaW5lcicpO1xuXG5cdFx0XHRpZiAoZGF0YUNvbnRhaW5lciAhPT0gbnVsbCkge1xuXHRcdFx0XHRkYXRhQ29udGFpbmVyLmlubmVySFRNTCA9ICcnO1xuXHRcdFx0fVxuXG5cdFx0XHRnZW5lcmF0ZURhdGFHcmlkKCk7XG5cdFx0fSk7XG5cdH1cblxuXHRpZiAodGVzdE9wdGlvbnNCdXR0b24gIT09IG51bGwpIHtcblx0XHR0ZXN0T3B0aW9uc0J1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uKCkge1xuXHRcdFx0d2luZG93LmNvbnNvbGUubG9nKGdldE9wdGlvbnNGcm9tSW5wdXRzKCkpO1xuXHRcdH0pO1xuXHR9XG5cblx0aWYgKHJlc2V0VG9EZWZhdWx0QnV0dG9uICE9PSBudWxsKSB7XG5cdFx0cmVzZXRUb0RlZmF1bHRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBzZXR1cE9wdGlvbnMpO1xuXHR9XG5cblx0aWYgKGdlbmVyYXRlRGF0YUJ1dHRvbiAhPT0gbnVsbCkge1xuXHRcdGdlbmVyYXRlRGF0YUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uKCkge1xuXHRcdFx0dmFyIGhlYWRlcnNJbnB1dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ1tuYW1lPWhlYWRlcnNdJyksXG5cdFx0XHRcdGZpeGVkSGVhZGVyc0lucHV0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignW25hbWU9Zml4ZWRIZWFkZXJzXScpLFxuXHRcdFx0XHRkYXRhU291cmNlSW5wdXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdbbmFtZT1kYXRhU291cmNlXScpLFxuXHRcdFx0XHRoZWFkZXJTaXplID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI2RhdGEtZ2VuZXJhdG9yLWhlYWRlci1zaXplJyksXG5cdFx0XHRcdGZpeGVkSGVhZGVyU2l6ZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNkYXRhLWdlbmVyYXRvci1maXhlZC1oZWFkZXItc2l6ZScpLFxuXHRcdFx0XHRoZWFkZXJzUm93U2l6ZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNkYXRhLWdlbmVyYXRvci1oZWFkZXJzLXJvdy1zaXplJyksXG5cdFx0XHRcdGRhdGFTaXplID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI2RhdGEtZ2VuZXJhdG9yLWRhdGEtc2l6ZScpO1xuXG5cdFx0XHRpZiAoaGVhZGVyc0lucHV0ID09PSBudWxsIHx8IGZpeGVkSGVhZGVyc0lucHV0ID09PSBudWxsIHx8IGRhdGFTb3VyY2VJbnB1dCA9PT0gbnVsbCB8fFxuXHRcdFx0XHRoZWFkZXJTaXplID09PSBudWxsIHx8IGZpeGVkSGVhZGVyU2l6ZSA9PT0gbnVsbCB8fCBoZWFkZXJzUm93U2l6ZSA9PT0gbnVsbCB8fCBkYXRhU2l6ZSA9PT0gbnVsbCkge1xuXHRcdFx0XHRyZXR1cm47XG5cdFx0XHR9XG5cblx0XHRcdHZhciBoZWFkZXJTaXplVmFsdWUgPSBwYXJzZUludChoZWFkZXJTaXplLnZhbHVlLCAxMCksXG5cdFx0XHRcdGZpeGVkSGVhZGVyU2l6ZVZhbHVlID0gcGFyc2VJbnQoZml4ZWRIZWFkZXJTaXplLnZhbHVlLCAxMCksXG5cdFx0XHRcdGhlYWRlcnNSb3dTaXplVmFsdWUgPSBwYXJzZUludChoZWFkZXJzUm93U2l6ZS52YWx1ZSwgMTApLFxuXHRcdFx0XHRkYXRhU2l6ZVZhbHVlID0gcGFyc2VJbnQoZGF0YVNpemUudmFsdWUsIDEwKSxcblx0XHRcdFx0aGVhZGVycyA9IGdlbmVyYXRlSGVhZGVycyhoZWFkZXJTaXplVmFsdWUsIGhlYWRlcnNSb3dTaXplVmFsdWUpLFxuXHRcdFx0XHRmaXhlZEhlYWRlcnMgPSBnZW5lcmF0ZUZpeGVkSGVhZGVycyhmaXhlZEhlYWRlclNpemVWYWx1ZSwgaGVhZGVyc1Jvd1NpemVWYWx1ZSksXG5cdFx0XHRcdGRhdGEgPSBnZW5lcmF0ZURhdGEoaGVhZGVycywgZml4ZWRIZWFkZXJzLCBkYXRhU2l6ZVZhbHVlKTtcblxuXHRcdFx0aGVhZGVyc0lucHV0LnZhbHVlID0gSlNPTi5zdHJpbmdpZnkoaGVhZGVycywgbnVsbCwgMik7XG5cdFx0XHRmaXhlZEhlYWRlcnNJbnB1dC52YWx1ZSA9IEpTT04uc3RyaW5naWZ5KGZpeGVkSGVhZGVycywgbnVsbCwgMik7XG5cdFx0XHRkYXRhU291cmNlSW5wdXQudmFsdWUgPSBKU09OLnN0cmluZ2lmeShkYXRhLCBudWxsLCAyKTtcblx0XHR9KTtcblx0fVxufSk7Il19
