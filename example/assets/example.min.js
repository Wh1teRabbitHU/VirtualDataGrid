"use strict";function generateHeader(){var e,t=[];for(t.push([]),e=2;e<52;e++)t[0].push({text:e+". column",colspan:4});for(t.push([]),e=2;e<102;e++)t[1].push({text:e+". column",colspan:2});for(t.push([]),t[2].push({key:"column_2",text:"2. column",dataType:"number",filterDisabled:!0,sortDisabled:!0}),t[2].push({key:"column_3",text:"3. column",dataType:"number",filterType:"custom"}),e=4;e<202;e++)t[2].push({key:"column_"+e,text:e+". column",dataType:"number"});return t}function generateFixedHeader(){var e=[];return e.push([]),e[0].push({text:" "}),e.push([]),e[1].push({text:" "}),e.push([]),e[2].push({key:"column_1",text:"1. column",dataType:"number"}),e}function generateData(e){for(var t=[],n=1;n<=2e3;n++){for(var r={column_1:n},a=1;a<=e[2].length;a++)r[e[2][a-1].key]=n*(a+1);t.push(r)}return t}function generateTable(e){var t=generateHeader(),n=generateData(t);!1!==e&&(virtualDG=new window.VirtualDataGrid),virtualDG.generateTable({dataSource:n,headers:t,fixedHeaders:generateFixedHeader(),selectors:{mainContainer:".data-container"},edit:{enabled:!0},sort:{enabled:!0},filter:{enabled:!0,customFilter:function(e){function t(t,n){var r=e.editedValues[t[e.uniqueRowKey]];return void 0===r||void 0===r[n]?t[n]:r[n]}return e.dataSource.filter(function(n){return t(n,e.attribute)<e.value})}}})}function setupOptionContainer(){var e=window.innerHeight-document.querySelector(".main-container").getBoundingClientRect().top-20;document.querySelector(".generator-container").style.maxHeight=e+"px"}function setupOptions(){virtualDG=new window.VirtualDataGrid,Object.keys(virtualDG.DEFAULT_OPTIONS).forEach(function(e){fillInputsWithOptions(e,virtualDG.DEFAULT_OPTIONS[e])})}function fillInputsWithOptions(e,t){null!==t&&"object"==typeof t&&Object.keys(t).forEach(function(n){fillInputsWithOptions(e+"-"+n,t[n])});var n=document.querySelector("[name="+e+"]");if(null!==n&&"function"!=typeof t){var r=n.getAttribute("type");"radio"===r||"checkbox"===r?document.querySelectorAll("[name="+e+"]").forEach(function(e){e.checked=e.value===t+""}):n.value=t}}function getOptionsFromInputs(){var e={},t={};return document.querySelectorAll("[name]").forEach(function(t){var n=t.getAttribute("type"),r=t.classList.contains("function"),a=t.classList.contains("json");if("radio"!==n&&"checkbox"!==n||t.matches(":checked")){var o=t.value;""!==o&&("true"===o?o=!0:"false"===o&&(o=!1),r&&(o=evalFunctionValues(t)),a&&(o=JSON.parse(t.value)),e[t.getAttribute("name")]=o)}}),Object.keys(e).forEach(function(n){for(var r=n.split("-"),a=null,o=0;o<r.length;o++){var u=r[o];null===a?r.length-1===o?t[u]=e[n]:(void 0===t[u]&&(t[u]={}),a=t[u]):r.length-1===o?a[u]=e[n]:(void 0===a[u]&&(a[u]={}),a=a[u])}}),t}function evalFunctionValues(e){var t=e.getAttribute("data-attributes").split(",");return Function(t,e.value)}function resizeEventHandler(){isEventDelayed||(isEventDelayed=!0,window.setTimeout(function(){isEventDelayed=!1,setupOptionContainer()},200))}function initPage(){setupOptionContainer(),setupOptions(),getOptionsFromInputs()}var virtualDG,isEventDelayed=!1;window.addEventListener("load",function(){initPage(),window.addEventListener("resize",resizeEventHandler),document.querySelector("#generate-table").addEventListener("click",function(){document.querySelector(".data-container").innerHTML="",generateTable()}),document.querySelector("#test-options").addEventListener("click",function(){window.console.log(getOptionsFromInputs())}),document.querySelector("#generate-data").addEventListener("click",function(){var e=document.querySelector("#datasource-generator-rows"),t=document.querySelector("#datasource-generator-columns");null!==e&&null!==t&&window.console.log(e.value,t.value)})});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1haW4uanMiXSwibmFtZXMiOlsiZ2VuZXJhdGVIZWFkZXIiLCJpIiwiaGVhZGVycyIsInB1c2giLCJ0ZXh0IiwiY29sc3BhbiIsImtleSIsImRhdGFUeXBlIiwiZmlsdGVyRGlzYWJsZWQiLCJzb3J0RGlzYWJsZWQiLCJmaWx0ZXJUeXBlIiwiZ2VuZXJhdGVGaXhlZEhlYWRlciIsImZpeGVkSGVhZGVycyIsImdlbmVyYXRlRGF0YSIsImRzIiwicm93IiwiY29sdW1uXzEiLCJqIiwibGVuZ3RoIiwiZ2VuZXJhdGVUYWJsZSIsImNyZWF0ZU5ld0luc3RhbmNlIiwiZGF0YSIsInZpcnR1YWxERyIsIndpbmRvdyIsIlZpcnR1YWxEYXRhR3JpZCIsImRhdGFTb3VyY2UiLCJzZWxlY3RvcnMiLCJtYWluQ29udGFpbmVyIiwiZWRpdCIsImVuYWJsZWQiLCJzb3J0IiwiZmlsdGVyIiwiY3VzdG9tRmlsdGVyIiwib3B0aW9ucyIsImdldE1lcmdlZFZhbHVlIiwiYXR0cmlidXRlIiwiZWRpdGVkUm93IiwiZWRpdGVkVmFsdWVzIiwidW5pcXVlUm93S2V5IiwidmFsdWUiLCJzZXR1cE9wdGlvbkNvbnRhaW5lciIsImdlbmVyYXRvckNvbnRhaW5lckhlaWdodCIsImlubmVySGVpZ2h0IiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwiZ2V0Qm91bmRpbmdDbGllbnRSZWN0IiwidG9wIiwic3R5bGUiLCJtYXhIZWlnaHQiLCJzZXR1cE9wdGlvbnMiLCJPYmplY3QiLCJrZXlzIiwiREVGQVVMVF9PUFRJT05TIiwiZm9yRWFjaCIsImZpbGxJbnB1dHNXaXRoT3B0aW9ucyIsImtleUNoYWluIiwic3ViS2V5IiwiaW5wdXQiLCJpbnB1dFR5cGUiLCJnZXRBdHRyaWJ1dGUiLCJxdWVyeVNlbGVjdG9yQWxsIiwiZWwiLCJjaGVja2VkIiwiZ2V0T3B0aW9uc0Zyb21JbnB1dHMiLCJmbGF0T3B0aW9ucyIsImlzRnVuY3Rpb24iLCJjbGFzc0xpc3QiLCJjb250YWlucyIsImlzSnNvbiIsIm1hdGNoZXMiLCJldmFsRnVuY3Rpb25WYWx1ZXMiLCJKU09OIiwicGFyc2UiLCJmbGF0S2V5IiwicGFydHMiLCJzcGxpdCIsInBhcnREYXRhIiwicGFydCIsInBhcmFtQXJyYXkiLCJGdW5jdGlvbiIsInJlc2l6ZUV2ZW50SGFuZGxlciIsImlzRXZlbnREZWxheWVkIiwic2V0VGltZW91dCIsImluaXRQYWdlIiwiYWRkRXZlbnRMaXN0ZW5lciIsImlubmVySFRNTCIsImNvbnNvbGUiLCJsb2ciLCJyb3dzIiwiY29sdW1ucyJdLCJtYXBwaW5ncyI6IkFBQUEsYUFJQSxTQUFTQSxpQkFDUixJQUVJQyxFQUZBQyxLQU1KLElBRkFBLEVBQVFDLFNBRUhGLEVBQUksRUFBR0EsRUFBSSxHQUFJQSxJQUNuQkMsRUFBUSxHQUFHQyxNQUNWQyxLQUFNSCxFQUFJLFdBQ1ZJLFFBQVMsSUFNWCxJQUZBSCxFQUFRQyxTQUVIRixFQUFJLEVBQUdBLEVBQUksSUFBS0EsSUFDcEJDLEVBQVEsR0FBR0MsTUFDVkMsS0FBTUgsRUFBSSxXQUNWSSxRQUFTLElBbUJYLElBZkFILEVBQVFDLFNBQ1JELEVBQVEsR0FBR0MsTUFDVkcsSUFBSyxXQUNMRixLQUFNLFlBQ05HLFNBQVUsU0FDVkMsZ0JBQWdCLEVBQ2hCQyxjQUFjLElBRWZQLEVBQVEsR0FBR0MsTUFDVkcsSUFBSyxXQUNMRixLQUFNLFlBQ05HLFNBQVUsU0FDVkcsV0FBWSxXQUdSVCxFQUFJLEVBQUdBLEVBQUksSUFBS0EsSUFDcEJDLEVBQVEsR0FBR0MsTUFDVkcsSUFBSyxVQUFZTCxFQUNqQkcsS0FBTUgsRUFBSSxXQUNWTSxTQUFVLFdBSVosT0FBT0wsRUFHUixTQUFTUyxzQkFDUixJQUFJQyxLQW1CSixPQWpCQUEsRUFBYVQsU0FDYlMsRUFBYSxHQUFHVCxNQUNmQyxLQUFNLE1BR1BRLEVBQWFULFNBQ2JTLEVBQWEsR0FBR1QsTUFDZkMsS0FBTSxNQUdQUSxFQUFhVCxTQUNiUyxFQUFhLEdBQUdULE1BQ2ZHLElBQUssV0FDTEYsS0FBTSxZQUNORyxTQUFV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IjoibWFpbi5qcyIsInNvdXJjZXNDb250ZW50IjpbIid1c2Ugc3RyaWN0JztcblxudmFyIHZpcnR1YWxERztcblxuZnVuY3Rpb24gZ2VuZXJhdGVIZWFkZXIoKSB7XG5cdHZhciBoZWFkZXJzID0gW107XG5cblx0dmFyIGk7XG5cblx0aGVhZGVycy5wdXNoKFtdKTtcblxuXHRmb3IgKGkgPSAyOyBpIDwgNTI7IGkrKykge1xuXHRcdGhlYWRlcnNbMF0ucHVzaCh7XG5cdFx0XHR0ZXh0OiBpICsgJy4gY29sdW1uJyxcblx0XHRcdGNvbHNwYW46IDRcblx0XHR9KTtcblx0fVxuXG5cdGhlYWRlcnMucHVzaChbXSk7XG5cblx0Zm9yIChpID0gMjsgaSA8IDEwMjsgaSsrKSB7XG5cdFx0aGVhZGVyc1sxXS5wdXNoKHtcblx0XHRcdHRleHQ6IGkgKyAnLiBjb2x1bW4nLFxuXHRcdFx0Y29sc3BhbjogMlxuXHRcdH0pO1xuXHR9XG5cblx0aGVhZGVycy5wdXNoKFtdKTtcblx0aGVhZGVyc1syXS5wdXNoKHtcblx0XHRrZXk6ICdjb2x1bW5fMicsXG5cdFx0dGV4dDogJzIuIGNvbHVtbicsXG5cdFx0ZGF0YVR5cGU6ICdudW1iZXInLFxuXHRcdGZpbHRlckRpc2FibGVkOiB0cnVlLFxuXHRcdHNvcnREaXNhYmxlZDogdHJ1ZVxuXHR9KTtcblx0aGVhZGVyc1syXS5wdXNoKHtcblx0XHRrZXk6ICdjb2x1bW5fMycsXG5cdFx0dGV4dDogJzMuIGNvbHVtbicsXG5cdFx0ZGF0YVR5cGU6ICdudW1iZXInLFxuXHRcdGZpbHRlclR5cGU6ICdjdXN0b20nLFxuXHR9KTtcblxuXHRmb3IgKGkgPSA0OyBpIDwgMjAyOyBpKyspIHtcblx0XHRoZWFkZXJzWzJdLnB1c2goe1xuXHRcdFx0a2V5OiAnY29sdW1uXycgKyBpLFxuXHRcdFx0dGV4dDogaSArICcuIGNvbHVtbicsXG5cdFx0XHRkYXRhVHlwZTogJ251bWJlcidcblx0XHR9KTtcblx0fVxuXG5cdHJldHVybiBoZWFkZXJzO1xufVxuXG5mdW5jdGlvbiBnZW5lcmF0ZUZpeGVkSGVhZGVyKCkge1xuXHR2YXIgZml4ZWRIZWFkZXJzID0gW107XG5cblx0Zml4ZWRIZWFkZXJzLnB1c2goW10pO1xuXHRmaXhlZEhlYWRlcnNbMF0ucHVzaCh7XG5cdFx0dGV4dDogJyAnXG5cdH0pO1xuXG5cdGZpeGVkSGVhZGVycy5wdXNoKFtdKTtcblx0Zml4ZWRIZWFkZXJzWzFdLnB1c2goe1xuXHRcdHRleHQ6ICcgJ1xuXHR9KTtcblxuXHRmaXhlZEhlYWRlcnMucHVzaChbXSk7XG5cdGZpeGVkSGVhZGVyc1syXS5wdXNoKHtcblx0XHRrZXk6ICdjb2x1bW5fMScsXG5cdFx0dGV4dDogJzEuIGNvbHVtbicsXG5cdFx0ZGF0YVR5cGU6ICdudW1iZXInXG5cdH0pO1xuXG5cdHJldHVybiBmaXhlZEhlYWRlcnM7XG59XG5cbmZ1bmN0aW9uIGdlbmVyYXRlRGF0YShoZWFkZXJzKSB7XG5cdHZhciBkcyA9IFtdO1xuXG5cdGZvciAodmFyIGkgPSAxOyBpIDw9IDIwMDA7IGkrKykge1xuXHRcdHZhciByb3cgPSB7XG5cdFx0XHRjb2x1bW5fMTogaVxuXHRcdH07XG5cblx0XHRmb3IgKHZhciBqID0gMTsgaiA8PSBoZWFkZXJzWzJdLmxlbmd0aDsgaisrKSB7XG5cdFx0XHR2YXIgY0tleSA9IGhlYWRlcnNbMl1baiAtIDFdLmtleTtcblxuXHRcdFx0cm93W2NLZXldID0gaSAqIChqICsgMSk7XG5cdFx0fVxuXG5cdFx0ZHMucHVzaChyb3cpO1xuXHR9XG5cblx0cmV0dXJuIGRzO1xufVxuXG5mdW5jdGlvbiBnZW5lcmF0ZVRhYmxlKGNyZWF0ZU5ld0luc3RhbmNlKSB7XG5cdHZhciBoZWFkZXJzID0gZ2VuZXJhdGVIZWFkZXIoKSxcblx0XHRkYXRhID0gZ2VuZXJhdGVEYXRhKGhlYWRlcnMpO1xuXG5cdGlmIChjcmVhdGVOZXdJbnN0YW5jZSAhPT0gZmFsc2UpIHtcblx0XHR2aXJ0dWFsREcgPSBuZXcgd2luZG93LlZpcnR1YWxEYXRhR3JpZCgpO1xuXHR9XG5cblx0dmlydHVhbERHLmdlbmVyYXRlVGFibGUoe1xuXHRcdGRhdGFTb3VyY2U6IGRhdGEsXG5cdFx0aGVhZGVyczogaGVhZGVycyxcblx0XHRmaXhlZEhlYWRlcnM6IGdlbmVyYXRlRml4ZWRIZWFkZXIoKSxcblx0XHRzZWxlY3RvcnM6IHtcblx0XHRcdG1haW5Db250YWluZXI6ICcuZGF0YS1jb250YWluZXInXG5cdFx0fSxcblx0XHRlZGl0OiB7XG5cdFx0XHRlbmFibGVkOiB0cnVlXG5cdFx0fSxcblx0XHRzb3J0OiB7XG5cdFx0XHRlbmFibGVkOiB0cnVlXG5cdFx0fSxcblx0XHRmaWx0ZXI6IHtcblx0XHRcdGVuYWJsZWQ6IHRydWUsXG5cdFx0XHRjdXN0b21GaWx0ZXI6IGZ1bmN0aW9uKG9wdGlvbnMpIHtcblx0XHRcdFx0ZnVuY3Rpb24gZ2V0TWVyZ2VkVmFsdWUocm93LCBhdHRyaWJ1dGUpIHtcblx0XHRcdFx0XHR2YXIgZWRpdGVkUm93ID0gb3B0aW9ucy5lZGl0ZWRWYWx1ZXNbcm93W29wdGlvbnMudW5pcXVlUm93S2V5XV07XG5cblx0XHRcdFx0XHRyZXR1cm4gdHlwZW9mIGVkaXRlZFJvdyA9PSAndW5kZWZpbmVkJyB8fCB0eXBlb2YgZWRpdGVkUm93W2F0dHJpYnV0ZV0gPT0gJ3VuZGVmaW5lZCcgPyByb3dbYXR0cmlidXRlXSA6IGVkaXRlZFJvd1thdHRyaWJ1dGVdO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0cmV0dXJuIG9wdGlvbnMuZGF0YVNvdXJjZS5maWx0ZXIoZnVuY3Rpb24ocm93KSB7XG5cdFx0XHRcdFx0cmV0dXJuIGdldE1lcmdlZFZhbHVlKHJvdywgb3B0aW9ucy5hdHRyaWJ1dGUpIDwgb3B0aW9ucy52YWx1ZTtcblx0XHRcdFx0fSk7XG5cdFx0XHR9XG5cdFx0fVxuXHR9KTtcbn1cblxuZnVuY3Rpb24gc2V0dXBPcHRpb25Db250YWluZXIoKSB7XG5cdHZhciBnZW5lcmF0b3JDb250YWluZXJIZWlnaHQgPSB3aW5kb3cuaW5uZXJIZWlnaHQgLSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcubWFpbi1jb250YWluZXInKS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS50b3AgLSAyMDtcblxuXHRkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuZ2VuZXJhdG9yLWNvbnRhaW5lcicpLnN0eWxlLm1heEhlaWdodCA9IGdlbmVyYXRvckNvbnRhaW5lckhlaWdodCArICdweCc7XG59XG5cbmZ1bmN0aW9uIHNldHVwT3B0aW9ucygpIHtcblx0dmlydHVhbERHID0gbmV3IHdpbmRvdy5WaXJ0dWFsRGF0YUdyaWQoKTtcblxuXHRPYmplY3Qua2V5cyh2aXJ0dWFsREcuREVGQVVMVF9PUFRJT05TKS5mb3JFYWNoKGZ1bmN0aW9uKGtleSkge1xuXHRcdGZpbGxJbnB1dHNXaXRoT3B0aW9ucyhrZXksIHZpcnR1YWxERy5ERUZBVUxUX09QVElPTlNba2V5XSk7XG5cdH0pO1xufVxuXG5mdW5jdGlvbiBmaWxsSW5wdXRzV2l0aE9wdGlvbnMoa2V5Q2hhaW4sIHZhbHVlKSB7XG5cdGlmICh2YWx1ZSAhPT0gbnVsbCAmJiB0eXBlb2YgdmFsdWUgPT09ICdvYmplY3QnKSB7XG5cdFx0T2JqZWN0LmtleXModmFsdWUpLmZvckVhY2goZnVuY3Rpb24oc3ViS2V5KSB7XG5cdFx0XHRmaWxsSW5wdXRzV2l0aE9wdGlvbnMoa2V5Q2hhaW4gKyAnLScgKyBzdWJLZXksIHZhbHVlW3N1YktleV0pO1xuXHRcdH0pO1xuXHR9XG5cblx0dmFyIGlucHV0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignW25hbWU9JyArIGtleUNoYWluICsgJ10nKTtcblxuXHRpZiAoaW5wdXQgIT09IG51bGwgJiYgdHlwZW9mIHZhbHVlICE9PSAnZnVuY3Rpb24nKSB7XG5cdFx0dmFyIGlucHV0VHlwZSA9IGlucHV0LmdldEF0dHJpYnV0ZSgndHlwZScpO1xuXG5cdFx0aWYgKGlucHV0VHlwZSA9PT0gJ3JhZGlvJyB8fCBpbnB1dFR5cGUgPT09ICdjaGVja2JveCcpIHtcblx0XHRcdGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJ1tuYW1lPScgKyBrZXlDaGFpbiArICddJykuZm9yRWFjaChmdW5jdGlvbihlbCkge1xuXHRcdFx0XHRlbC5jaGVja2VkID0gZWwudmFsdWUgPT09IHZhbHVlICsgJyc7XG5cdFx0XHR9KTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0aW5wdXQudmFsdWUgPSB2YWx1ZTtcblx0XHR9XG5cdH1cbn1cblxuZnVuY3Rpb24gZ2V0T3B0aW9uc0Zyb21JbnB1dHMoKSB7XG5cdHZhciBpbnB1dHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCdbbmFtZV0nKSxcblx0XHRmbGF0T3B0aW9ucyA9IHt9LFxuXHRcdG9wdGlvbnMgPSB7fTtcblxuXHRpbnB1dHMuZm9yRWFjaChmdW5jdGlvbihpbnB1dCkge1xuXHRcdHZhciBpbnB1dFR5cGUgPSBpbnB1dC5nZXRBdHRyaWJ1dGUoJ3R5cGUnKSxcblx0XHRcdGlzRnVuY3Rpb24gPSBpbnB1dC5jbGFzc0xpc3QuY29udGFpbnMoJ2Z1bmN0aW9uJyksXG5cdFx0XHRpc0pzb24gPSBpbnB1dC5jbGFzc0xpc3QuY29udGFpbnMoJ2pzb24nKTtcblxuXHRcdGlmICgoaW5wdXRUeXBlID09PSAncmFkaW8nIHx8IGlucHV0VHlwZSA9PT0gJ2NoZWNrYm94JykgJiYgIWlucHV0Lm1hdGNoZXMoJzpjaGVja2VkJykpIHtcblx0XHRcdHJldHVybjtcblx0XHR9XG5cblx0XHR2YXIgdmFsdWUgPSBpbnB1dC52YWx1ZTtcblxuXHRcdGlmICh2YWx1ZSA9PT0gJycpIHtcblx0XHRcdHJldHVybjtcblx0XHR9XG5cblx0XHRpZiAodmFsdWUgPT09ICd0cnVlJykge1xuXHRcdFx0dmFsdWUgPSB0cnVlO1xuXHRcdH0gZWxzZSBpZiAodmFsdWUgPT09ICdmYWxzZScpIHtcblx0XHRcdHZhbHVlID0gZmFsc2U7XG5cdFx0fVxuXG5cdFx0aWYgKGlzRnVuY3Rpb24pIHtcblx0XHRcdHZhbHVlID0gZXZhbEZ1bmN0aW9uVmFsdWVzKGlucHV0KTtcblx0XHR9XG5cblx0XHRpZiAoaXNKc29uKSB7XG5cdFx0XHR2YWx1ZSA9IEpTT04ucGFyc2UoaW5wdXQudmFsdWUpO1xuXHRcdH1cblxuXHRcdGZsYXRPcHRpb25zW2lucHV0LmdldEF0dHJpYnV0ZSgnbmFtZScpXSA9IHZhbHVlO1xuXHR9KTtcblxuXHRPYmplY3Qua2V5cyhmbGF0T3B0aW9ucykuZm9yRWFjaChmdW5jdGlvbihmbGF0S2V5KSB7XG5cdFx0dmFyIHBhcnRzID0gZmxhdEtleS5zcGxpdCgnLScpLFxuXHRcdFx0cGFydERhdGEgPSBudWxsO1xuXG5cdFx0Zm9yICh2YXIgaSA9IDA7IGkgPCBwYXJ0cy5sZW5ndGg7IGkrKykge1xuXHRcdFx0dmFyIHBhcnQgPSBwYXJ0c1tpXTtcblxuXHRcdFx0aWYgKHBhcnREYXRhID09PSBudWxsKSB7XG5cdFx0XHRcdGlmIChwYXJ0cy5sZW5ndGggLSAxID09PSBpKSB7XG5cdFx0XHRcdFx0b3B0aW9uc1twYXJ0XSA9IGZsYXRPcHRpb25zW2ZsYXRLZXldO1xuXHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdGlmICh0eXBlb2Ygb3B0aW9uc1twYXJ0XSA9PSAndW5kZWZpbmVkJykge1xuXHRcdFx0XHRcdFx0b3B0aW9uc1twYXJ0XSA9IHt9O1xuXHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdHBhcnREYXRhID0gb3B0aW9uc1twYXJ0XTtcblx0XHRcdFx0fVxuXHRcdFx0fSBlbHNlIGlmIChwYXJ0cy5sZW5ndGggLSAxID09PSBpKSB7XG5cdFx0XHRcdHBhcnREYXRhW3BhcnRdID0gZmxhdE9wdGlvbnNbZmxhdEtleV07XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRpZiAodHlwZW9mIHBhcnREYXRhW3BhcnRdID09ICd1bmRlZmluZWQnKSB7XG5cdFx0XHRcdFx0cGFydERhdGFbcGFydF0gPSB7fTtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdHBhcnREYXRhID0gcGFydERhdGFbcGFydF07XG5cdFx0XHR9XG5cdFx0fVxuXHR9KTtcblxuXHRyZXR1cm4gb3B0aW9ucztcbn1cblxuZnVuY3Rpb24gZXZhbEZ1bmN0aW9uVmFsdWVzKGlucHV0KSB7XG5cdHZhciBwYXJhbUFycmF5ID0gaW5wdXQuZ2V0QXR0cmlidXRlKCdkYXRhLWF0dHJpYnV0ZXMnKS5zcGxpdCgnLCcpO1xuXG5cdHJldHVybiBGdW5jdGlvbihwYXJhbUFycmF5LCBpbnB1dC52YWx1ZSk7IC8vIGVzbGludC1kaXNhYmxlLWxpbmVcbn1cblxudmFyIGlzRXZlbnREZWxheWVkID0gZmFsc2U7XG5cbmZ1bmN0aW9uIHJlc2l6ZUV2ZW50SGFuZGxlcigpIHtcblx0aWYgKCFpc0V2ZW50RGVsYXllZCkge1xuXHRcdGlzRXZlbnREZWxheWVkID0gdHJ1ZTtcblxuXHRcdHdpbmRvdy5zZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xuXHRcdFx0aXNFdmVudERlbGF5ZWQgPSBmYWxzZTtcblxuXHRcdFx0c2V0dXBPcHRpb25Db250YWluZXIoKTtcblx0XHR9LCAyMDApO1xuXHR9XG59XG5cbmZ1bmN0aW9uIGluaXRQYWdlKCkge1xuXHRzZXR1cE9wdGlvbkNvbnRhaW5lcigpO1xuXHRzZXR1cE9wdGlvbnMoKTtcblx0Z2V0T3B0aW9uc0Zyb21JbnB1dHMoKTtcbn1cblxud2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ2xvYWQnLCBmdW5jdGlvbigpIHtcblx0aW5pdFBhZ2UoKTtcblx0Ly8gZ2VuZXJhdGVUYWJsZShmYWxzZSk7XG5cblx0d2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ3Jlc2l6ZScsIHJlc2l6ZUV2ZW50SGFuZGxlcik7XG5cblx0ZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI2dlbmVyYXRlLXRhYmxlJykuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbigpIHtcblx0XHRkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuZGF0YS1jb250YWluZXInKS5pbm5lckhUTUwgPSAnJztcblxuXHRcdGdlbmVyYXRlVGFibGUoKTtcblx0fSk7XG5cblx0ZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI3Rlc3Qtb3B0aW9ucycpLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24oKSB7XG5cdFx0d2luZG93LmNvbnNvbGUubG9nKGdldE9wdGlvbnNGcm9tSW5wdXRzKCkpO1xuXHR9KTtcblxuXHRkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjZ2VuZXJhdGUtZGF0YScpLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24oKSB7XG5cdFx0dmFyIHJvd3MgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjZGF0YXNvdXJjZS1nZW5lcmF0b3Itcm93cycpLFxuXHRcdFx0Y29sdW1ucyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNkYXRhc291cmNlLWdlbmVyYXRvci1jb2x1bW5zJyk7XG5cblx0XHRpZiAocm93cyA9PT0gbnVsbCB8fCBjb2x1bW5zID09PSBudWxsKSB7XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXG5cdFx0d2luZG93LmNvbnNvbGUubG9nKHJvd3MudmFsdWUsIGNvbHVtbnMudmFsdWUpO1xuXHR9KTtcbn0pOyJdfQ==
